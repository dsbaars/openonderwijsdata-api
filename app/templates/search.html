{% extends "base.html" %}

{% block main %}
<section ng-controller="SearchCtrl">
	<div class="">
		<form role="form" action="/search" method="GET">
			<div class="input-group">
				<input name="q" type="search" placeholder="Enter a name, place, zip code or BRIN" class="form-control search-query">
				<span class="input-group-btn">
					<button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search"></span> Search</button>
				</span>
			</div>
		</form>
	</div>
{% raw %}
<small>Found {{ total }} documents in {{ took }} ms.</small>
{% endraw %}
<table class="table table-striped table-condensed">
	<thead>
		<tr>
			<th>Index</th>
			<th>Type</th>
			<th>BRIN</th>
			<th>Board ID</th>
			<th>Branch ID</th>
			<th></th>
			<th>Ref. year</th>
		</tr>
	</thead>
	{% raw %}
	<tbody>
		<tr ng-repeat="hit in results">
			<td>{{ hit['_index'] }}</td>
			<td>{{ hit['_type'] }}</td>
			<td>{{ hit['_source'].brin }}</td>
			<td>{{ hit['_source'].board_id }}</td>
			<td>{{ hit['_source'].branch_id }}</td>
			<td>
				<address>
					<strong ng-if="hit['_source']"><a ng-href="/api/v1/get_document/{{ hit['_index'] }}/{{ hit['_type'] }}/{{ hit['_id'] }}" target="_blank">{{ hit['_source'].name }}</a></strong>
					<strong ng-if="!hit['_source']"><a ng-href="/api/v1/get_document/{{ hit['_index'] }}/{{ hit['_type'] }}/{{ hit['_id'] }}" target="_blank">{{ hit['_index'] }}/{{ hit['_type'] }}/{{ hit['_id'] }}</a></strong>
					<br>
				<span ng-if="hit['_source'].address">
					{{ hit['_source'].address.street }}<br>
					{{ hit['_source'].address.zip_code }} {{ hit['_source'].address.city }}<br>
				</span>
				</address>
			</td>
			<td>{{ hit['_source'].reference_year }}</td>
		</tr>
	</tbody>
	{% endraw %}
</table>
</section>
{% endblock %}
